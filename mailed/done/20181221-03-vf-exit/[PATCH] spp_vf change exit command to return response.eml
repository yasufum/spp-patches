From - Fri Dec 21 15:24:44 2018
X-Account-Key: account1
X-UIDL: 00008e0b56a584ea
X-Mozilla-Status: 0001
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                 
Return-Path: <x-fn-spp@sl.ntt-tx.co.jp>
X-Original-To: yo128@mail2.ecl.ntt.co.jp
Delivered-To: yo128@mail2.ecl.ntt.co.jp
Received: from dmail2.ecl.ntt.co.jp (dmail2.ecl.ntt.co.jp [129.60.86.152])
	by jcms-pop21.ecl.ntt.co.jp (Postfix) with ESMTP id 79FA1400793
	for <yo128@mail2.ecl.ntt.co.jp>; Fri, 21 Dec 2018 15:24:40 +0900 (JST)
Received: by dmail2.ecl.ntt.co.jp (Postfix)
	id 762AE7F33F; Fri, 21 Dec 2018 15:24:40 +0900 (JST)
Delivered-To: ogawa.yasufumi@lab.ntt.co.jp
Received: from vc2.ecl.ntt.co.jp (vc2.ecl.ntt.co.jp [129.60.86.154])
	by dmail2.ecl.ntt.co.jp (Postfix) with ESMTP id 74CEB7F089
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 21 Dec 2018 15:24:40 +0900 (JST)
Received: from vc2.ecl.ntt.co.jp (localhost [127.0.0.1])
	by vc2.ecl.ntt.co.jp (Postfix) with ESMTP id 66435638A5B
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 21 Dec 2018 15:24:40 +0900 (JST)
Received: from dcma-spm02.ecl.ntt.co.jp (unknown [129.60.87.149])
	by vc2.ecl.ntt.co.jp (Postfix) with ESMTP id 5ACBB638A00
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 21 Dec 2018 15:24:40 +0900 (JST)
Authentication-Results: dcma-spm02.ecl.ntt.co.jp; spf=Pass smtp.pra=x-fn-spp@sl.ntt-tx.co.jp; spf=Pass smtp.mailfrom=x-fn-spp@sl.ntt-tx.co.jp
Received-SPF: Pass (dcma-spm02.ecl.ntt.co.jp: domain of
  x-fn-spp@sl.ntt-tx.co.jp designates 210.232.35.69 as
  permitted sender) identity=pra; client-ip=210.232.35.69;
  receiver=dcma-spm02.ecl.ntt.co.jp;
  envelope-from="x-fn-spp@sl.ntt-tx.co.jp";
  x-sender="x-fn-spp@sl.ntt-tx.co.jp";
  x-conformance=sidf_strict; x-record-type="v=spf1";
  x-record-text="v=spf1 a:mail03.ics.ntt-tx.co.jp
  a:mail04.ics.ntt-tx.co.jp a:mail05.ics.ntt-tx.co.jp
  a:mail06.ics.ntt-tx.co.jp a:mail07.ics.ntt-tx.co.jp
  a:mail08.ics.ntt-tx.co.jp ip4:210.232.35.195
  ip4:210.232.35.196 ip4:210.232.35.65 ip4:210.232.35.66 ~all"
Received-SPF: Pass (dcma-spm02.ecl.ntt.co.jp: domain of
  x-fn-spp@sl.ntt-tx.co.jp designates 210.232.35.69 as
  permitted sender) identity=mailfrom; client-ip=210.232.35.69;
  receiver=dcma-spm02.ecl.ntt.co.jp;
  envelope-from="x-fn-spp@sl.ntt-tx.co.jp";
  x-sender="x-fn-spp@sl.ntt-tx.co.jp";
  x-conformance=sidf_strict; x-record-type="v=spf1";
  x-record-text="v=spf1 a:mail03.ics.ntt-tx.co.jp
  a:mail04.ics.ntt-tx.co.jp a:mail05.ics.ntt-tx.co.jp
  a:mail06.ics.ntt-tx.co.jp a:mail07.ics.ntt-tx.co.jp
  a:mail08.ics.ntt-tx.co.jp ip4:210.232.35.195
  ip4:210.232.35.196 ip4:210.232.35.65 ip4:210.232.35.66 ~all"
IronPort-PHdr: =?us-ascii?q?9a23=3Azdjz0hNG7AOcFdweVXYl6mtXPHoOpqn0MwgJ65?=
 =?us-ascii?q?Eul7NJdOGZ8o//OFDEvKwy3lPCWIye8OpB07CQvqvkH2oc/dCKtzYAaM8ETA?=
 =?us-ascii?q?cL3P0fhBdoG8uZEQvjNve/f2k0GoFZTEdN5HX9N1RJXdruIVbV5H+qvnYJAh?=
 =?us-ascii?q?uqDQNuPazuH5LKycG+1uS84ZrWNhUNijz4eqtqBA6y6wPNqowKkc1pLeAz0k?=
 =?us-ascii?q?KT8EFFcOlX225kYGmrsUikuZWI9YV4u2RcsPcostVYVP2gOakzSfpeEChgOG?=
 =?us-ascii?q?dz5tW5/RXESAKO4DMbXAB02lJYRgbDqQriRr/qtm38qvY4xDncNsqwT6h8VT?=
 =?us-ascii?q?m57qhtQQPlk29dbmZ/qjqNzJctyvwK6Bu6wn43i5bZeoSUKOZzcuvGcNUWSH?=
 =?us-ascii?q?AAFsddWipdA5+tOpMVBrlJNuJZoo/h4loW+EHnXU/2X7mpkWIO2C6luM9ym/?=
 =?us-ascii?q?4sGgzHwgE6St4FtX2Rt83wbP1UXOuxiq/U0XPIaLVUwWSYisCAfxY/rPWLRb?=
 =?us-ascii?q?81f9DWzBxlB0bLiBCLsZTNJDfT0PgR9nSLqeFnE+C3wT1CyUk5sn20y8Egh5?=
 =?us-ascii?q?OczJJQxFaB7j1h6J0xY9ukVAtncZivF91Sr2vJUuk+CtNnSGZutiEgz7QAsp?=
 =?us-ascii?q?PuZykGxqM82wTeYODUO5jN+B/oU/ydZCtpnH8wMqzqnA68qALzr4+0Htnxyl?=
 =?us-ascii?q?tBqTBJ18XBpmxYnQKG8dCJE7N0rEKo2DLXjEbS4foCJ1wo0LbLbZUmhLwo8/?=
 =?us-ascii?q?hb+U2RGyb3nB2qyq6dbQMi5vTt9/ShabKgpIfUPt1xgwD6avlom8ekR+IkLk?=
 =?us-ascii?q?0STy6Q/qK+zNiBtQXwErBDj/luzO/Yu4ucI9gH47KpRQRSlIQ7ox/tCj6n1I?=
 =?us-ascii?q?xH23gMNxRDZA7Ck5ivMFaIIuidb7/3igapmTZvn6CAP7b6RJPRMj3fgPHqev?=
 =?us-ascii?q?B/8wZd0FZhl4kHocgPUPdafbSqCxKU1pSQDwdlYVbtm6C9U487jd5YADPRSq?=
 =?us-ascii?q?6BbPGI6AfOvLl1ZbLRItFI8Dfld6p/vqao1yRj3wRAO/f3lY0ebHTyR640GU?=
 =?us-ascii?q?iSbHvyj9tEKl8k4FNkHtTjk0bKETJYYn/3RLo5vmt9BYmiS4HfWsamh/qDxH?=
 =?us-ascii?q?XzEppTb2FAQleCdBWgP5XBVfFJczqKCtRl1DoYSf29W8kq0lesrEf2xqFmIe?=
 =?us-ascii?q?zd5iAD/ci6jJ4vvLeVzkx0q208Bt/4sSnFV2xum2IUWzI6lLtyp0Bw0BbL0K?=
 =?us-ascii?q?R1heBZCc0G4vpIVgkgMpuPh+d+Ct30RkfAZoLTEQ7gGI78R2psCIxgkLpsKw?=
 =?us-ascii?q?5nFt6vjw7OxX+mCLoc0qeTAcRutK/X2z73O9o7wHGA1rFy6jtuCsZJK2Cigb?=
 =?us-ascii?q?ZysgbJAIuc2VXcmaDvbrwE9DXJsmGf0S+SrAdTV0hySe+WOBJXLluTttn/6k?=
 =?us-ascii?q?7YGvW+TLohdxBZ0eaZLu1MdsGskUUAT/ClOsyUMAfT0y+gQB2PwL2Ldo/jfW?=
 =?us-ascii?q?4QiT7cBEYziBwJ/H2aZkAuQz2sqGXEAHlyBEriNgnypPJmpirxHSpWh0maKl?=
 =?us-ascii?q?ds3L2v9lsJiOyAHrkNi6kctn5pomdxFVe5h4mQCtGb4Qx9YOBAcZU25xFFzQ?=
 =?us-ascii?q?e7/0R0bJmpLqQ62hgfeB8xuV/ykglnTI5H18oy5Hp4yQNzLfrFllJKbHWewY?=
 =?us-ascii?q?y1Jq2RIW60/gjKCeae0wPb2deSovlJ6f8j7VP/oES1Bgwp9DNly5FcgX6V55?=
 =?us-ascii?q?GSU0wTWom3VForsgRq4brdJCslguGcnXQ+NKC1tmeSndMiH60j1grlY8cZO6?=
 =?us-ascii?q?TCFhe6EtVGVZL3cKpwwALvNU9CZbEPkcx8d8K+K6ncgfbtZr062mn7yz0Wvs?=
 =?us-ascii?q?h8yh7erXMkDLSThdBenrfGg0OGT2uu1g759Jqsw8YfOHdMQCKpwCzgTtcANJ?=
 =?us-ascii?q?03Rp4CDCKVG+Pyw9x/g5D3XHsBqwy4AxUAxNPsZQrUZFu73xUCjB1L80zioj?=
 =?us-ascii?q?OxynlPqx9strCWhXOc2OCkcgYbf3JbAmJly1X0c9G5?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AAAABAhhxcmEUj6NJkGgEBAQEBAgE?=
 =?us-ascii?q?BAQEHAgEBAQGBUQUBAQEBCwGCAIFZAwcIJ4wWX6UIgXuEeTeCWAEFLwkNAQM?=
 =?us-ascii?q?BAQIBAQEBFAEBAQEBBg0LBikvhjwwDDRPEoMiggGoCYkKgSyHfoF9hFqIbYN?=
 =?us-ascii?q?wgiYChzUHiR6QYgmRZRiRXAEsiSGSBoIOhCyCNY41MAEBATABjFKCTQEB?=
X-SPF-Status: pass
Received: from mail05.ics.ntt-tx.co.jp (HELO mail04.ics.ntt-tx.co.jp) ([210.232.35.69])
  by dcma-spm02.ecl.ntt.co.jp with ESMTP; 21 Dec 2018 15:24:40 +0900
Received: from gwchk03.silk.ntt-tx.co.jp (gwchk03.silk.ntt-tx.co.jp [10.107.0.111])
	by mail04.ics.ntt-tx.co.jp (unknown) with ESMTP id wBL6OTIe020821;
	Fri, 21 Dec 2018 15:24:29 +0900
Received: (from root@localhost)
	by gwchk03.silk.ntt-tx.co.jp (unknown) id wBL6OTgH031357;
	Fri, 21 Dec 2018 15:24:29 +0900
Received: from gwchk.silk.ntt-tx.co.jp [10.107.0.110] 
	 by gwchk03.silk.ntt-tx.co.jp with ESMTP id RAA30930;
	 Fri, 21 Dec 2018 15:23:45 +0900
Received: from imss03.silk.ntt-tx.co.jp (localhost [127.0.0.1]) by imss03.silk.ntt-tx.co.jp (unknown) with ESMTP id wBL6NiTl008248; Fri, 21 Dec 2018 15:23:44 +0900
Received: from mgate01.silk.ntt-tx.co.jp (smtp02.silk.ntt-tx.co.jp [10.107.0.37]) by imss03.silk.ntt-tx.co.jp (unknown) with ESMTP id wBL6NiXF008245; Fri, 21 Dec 2018 15:23:44 +0900
Message-Id: <201812210623.wBL6NiXF008245@imss03.silk.ntt-tx.co.jp>
Received: from localhost by mgate01.silk.ntt-tx.co.jp (unknown)
	id wBL6NiHZ021755 ; Fri, 21 Dec 2018 15:23:44 +0900
From: x-fn-spp@sl.ntt-tx.co.jp
To: ferruh.yigit@intel.com, ogawa.yasufumi@lab.ntt.co.jp
Cc: spp@dpdk.org
Subject: [PATCH] spp_vf: change exit command to return response
Date: Fri, 21 Dec 2018 15:23:44 +0900
X-Mailer: git-send-email 2.18.0
X-TM-AS-MML: disable

From: Hideyuki Yamashita <yamashita.hideyuki@po.ntt-tx.co.jp>

For secondary processes use common process_request(), it causes an
error because spp-ctl expects a response but these processes do not
return anything. This patch is to change it to return message.

Signed-off-by: Hideyuki Yamashita <yamashita.hideyuki@po.ntt-tx.co.jp>
Signed-off-by: Naoki Takada <takada.naoki@lab.ntt.co.jp>
---
 src/vf/common/command_proc.c | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/src/vf/common/command_proc.c b/src/vf/common/command_proc.c
index cf35ce0..a612061 100644
--- a/src/vf/common/command_proc.c
+++ b/src/vf/common/command_proc.c
@@ -1600,8 +1600,10 @@ process_request(int *sock, const char *request_str, size_t request_str_len)
 	if (request.is_requested_exit) {
 		/* Terminated by process exit command.                       */
 		/* Other route is normal end because it responds to command. */
+		set_command_results(&command_results[0], CRES_SUCCESS, "");
+		send_command_result_response(sock, &request, command_results);
 		RTE_LOG(INFO, SPP_COMMAND_PROC,
-				"No response with process exit command.\n");
+				"Terminate process for exit.\n");
 		return SPP_RET_NG;
 	}
 
-- 
2.17.1



