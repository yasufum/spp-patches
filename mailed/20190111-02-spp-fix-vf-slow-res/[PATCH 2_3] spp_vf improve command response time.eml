From - Fri Jan 11 13:30:42 2019
X-Account-Key: account1
X-UIDL: 000094e856a584ea
X-Mozilla-Status: 0001
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                 
Return-Path: <x-fn-spp@sl.ntt-tx.co.jp>
X-Original-To: yo128@mail2.ecl.ntt.co.jp
Delivered-To: yo128@mail2.ecl.ntt.co.jp
Received: from dmail2.ecl.ntt.co.jp (dmail2.ecl.ntt.co.jp [129.60.86.152])
	by jcms-pop21.ecl.ntt.co.jp (Postfix) with ESMTP id D1628400B68
	for <yo128@mail2.ecl.ntt.co.jp>; Fri, 11 Jan 2019 13:30:24 +0900 (JST)
Received: by dmail2.ecl.ntt.co.jp (Postfix)
	id CEB577F3F6; Fri, 11 Jan 2019 13:30:24 +0900 (JST)
Delivered-To: ogawa.yasufumi@lab.ntt.co.jp
Received: from vc2.ecl.ntt.co.jp (vc2.ecl.ntt.co.jp [129.60.86.154])
	by dmail2.ecl.ntt.co.jp (Postfix) with ESMTP id CDAD67F3F1
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 11 Jan 2019 13:30:24 +0900 (JST)
Received: from vc2.ecl.ntt.co.jp (localhost [127.0.0.1])
	by vc2.ecl.ntt.co.jp (Postfix) with ESMTP id BFE3A638A34
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 11 Jan 2019 13:30:24 +0900 (JST)
Received: from dcma-spm02.ecl.ntt.co.jp (unknown [129.60.87.149])
	by vc2.ecl.ntt.co.jp (Postfix) with ESMTP id AAB9B6388F4
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 11 Jan 2019 13:30:24 +0900 (JST)
Authentication-Results: dcma-spm02.ecl.ntt.co.jp; spf=Pass smtp.pra=x-fn-spp@sl.ntt-tx.co.jp; spf=Pass smtp.mailfrom=x-fn-spp@sl.ntt-tx.co.jp
Received-SPF: Pass (dcma-spm02.ecl.ntt.co.jp: domain of
  x-fn-spp@sl.ntt-tx.co.jp designates 210.232.35.69 as
  permitted sender) identity=pra; client-ip=210.232.35.69;
  receiver=dcma-spm02.ecl.ntt.co.jp;
  envelope-from="x-fn-spp@sl.ntt-tx.co.jp";
  x-sender="x-fn-spp@sl.ntt-tx.co.jp";
  x-conformance=sidf_strict; x-record-type="v=spf1";
  x-record-text="v=spf1 a:mail03.ics.ntt-tx.co.jp
  a:mail04.ics.ntt-tx.co.jp a:mail05.ics.ntt-tx.co.jp
  a:mail06.ics.ntt-tx.co.jp a:mail07.ics.ntt-tx.co.jp
  a:mail08.ics.ntt-tx.co.jp ip4:210.232.35.195
  ip4:210.232.35.196 ip4:210.232.35.65 ip4:210.232.35.66 ~all"
Received-SPF: Pass (dcma-spm02.ecl.ntt.co.jp: domain of
  x-fn-spp@sl.ntt-tx.co.jp designates 210.232.35.69 as
  permitted sender) identity=mailfrom; client-ip=210.232.35.69;
  receiver=dcma-spm02.ecl.ntt.co.jp;
  envelope-from="x-fn-spp@sl.ntt-tx.co.jp";
  x-sender="x-fn-spp@sl.ntt-tx.co.jp";
  x-conformance=sidf_strict; x-record-type="v=spf1";
  x-record-text="v=spf1 a:mail03.ics.ntt-tx.co.jp
  a:mail04.ics.ntt-tx.co.jp a:mail05.ics.ntt-tx.co.jp
  a:mail06.ics.ntt-tx.co.jp a:mail07.ics.ntt-tx.co.jp
  a:mail08.ics.ntt-tx.co.jp ip4:210.232.35.195
  ip4:210.232.35.196 ip4:210.232.35.65 ip4:210.232.35.66 ~all"
IronPort-PHdr: =?us-ascii?q?9a23=3AzarxfhMR1OxX4p76dLcl6mtXPHoOpqn0MwgJ65?=
 =?us-ascii?q?Eul7NJdOGZ8o//OFDEvKwy3lPCWIye8OpB07CQvqvkH2oc/dCKtzYAaM8ETA?=
 =?us-ascii?q?cL3P0fhBdoG8uZEQvjNve/f2k0GoFZTEdN5HX9N1RJXdruIVbV5H+qvnYJAh?=
 =?us-ascii?q?uqDQNuPazuH5LKycG+1uS84ZrWNhUNijz4eqtqBA6y6wPNqowKkc1pLeAz0k?=
 =?us-ascii?q?KT8EFFcOlX225kYGmrsUikuZWI9YV4u2RcsPcostVYVP2gOakzSfpeEChgOG?=
 =?us-ascii?q?dz5tW5/RXESAKO4DMbXAB02lJYRgbDqQriRr/qtm38qvY4xDncNsqwT6h8VT?=
 =?us-ascii?q?m57qhtQQPlk29dbmZ/qjqNzJctyvwK6Bu6wn43i5bZeoSUKOZzcuvGcNUWSH?=
 =?us-ascii?q?AAFsddWipdA5+tOpMVBrlJNuJZoo/h4loW+EHnXU/2X7mpkWIO2C6luM9ym/?=
 =?us-ascii?q?4sGgzHwgE6St4FtX2Rt83wbP1UXOuxiq/U0XPIaLVUwWSYisCAfxY/rPWLRb?=
 =?us-ascii?q?81f9DWzBxlB0bLiBCLsZTNJDfT0PgR9nSLqeFnE+C3wT1CyUk5sn20y8Egh5?=
 =?us-ascii?q?OczJJQxFaB7j1h6J0xY9ukVAtncZivF91Sr2vJUuk+CtNnSGZutiEgz7QAsp?=
 =?us-ascii?q?PuZykGxqM82wTeYODUO5jN+B/oU/ydZCtpnH8wMqzqnA68qALzr4+0Htnxyl?=
 =?us-ascii?q?tBqTBJ18XBpmxYnQKG8dCJE7N0rEKo2DLXjEbS4foCJ1wo0LbLbZUmhLwo8/?=
 =?us-ascii?q?hb+U2RGyb3nB2qyq6dbQMi5vTt9/ShabKgpIfUPt1xgwD6avlom8ekR+IkLk?=
 =?us-ascii?q?0STy6Q/qK+zNiBtQXwErBDj/luzO/Yu4ucI9gH47KpRQRSlIQ7ox/tCj6n1I?=
 =?us-ascii?q?xH23gMNxRDZA7Ck5ivMFaIIuidb7/3igapmTZvn6CAP7b6RJPRMj3fgPHqev?=
 =?us-ascii?q?B/8wZd0FZhl4kHocgPUPdafbSqCxKU1pSQDwdlYVbtm6C9U487jd5YADPRSq?=
 =?us-ascii?q?6BbPGI6AfOvLl1ZbLRItFI8Dfld6p/vqao1yRj3wRAO/f3lY0ebHTyR640GU?=
 =?us-ascii?q?iSbHvyj9tEKl8k4FNkHtTjk0bKETJYYn/3RLo5vmt9BYmiS4HfWsamh/qDxH?=
 =?us-ascii?q?XzEppTb2FAQleCdBWgP5XBVfFJczqKCtRl1DoYSf29W8kq0lesrEf2xqFmIe?=
 =?us-ascii?q?zd5iAD/ci6jJ4vvLeVzkx0q208Bt/4sSnFV2xum2IUWzI6lLtyp0Bw0BbL0K?=
 =?us-ascii?q?R1heBZCc0G4vpIVgkgMpuPh+d+Ct30RkfAZoLTEQ7gGI78R2psCIxgkLpsKw?=
 =?us-ascii?q?5nFt6vjw7OxX+mCLoc0qeTAcRutK/X2z73O9o7wHGA1rFy6jtuCsZJK2Cigb?=
 =?us-ascii?q?ZysgbJAIuc2VXcmaDvbrwE9DXJsmGf0S+SrAdTV0hySe+WOBJXLluTttn/6k?=
 =?us-ascii?q?7YGvW+TLohdxBZ0eaZLu1MdsGskUUAT/ClOsyUMAfT0y+gQB2PwL2Ldo/jfW?=
 =?us-ascii?q?4QiT7cBEYziBwJ/H2aZkAuQz2sqGXEAHlyBEriNgnypPJmpirxHSpWh0maKl?=
 =?us-ascii?q?ds3L2v9lsJiOyAHrkNi6kctn5pomdxFVe5h4mQCtGb4Qx9YOBAcZU25xFFzQ?=
 =?us-ascii?q?e7/0R0bJmpLqQ62hgfeB8xuV/ykglnTI5H18oy5Hp4yQNzLfrFllJKbHWewY?=
 =?us-ascii?q?y1Jq2RIW60/gjKCeae0wPb2deSovlJ6f8j7VP/oES1Bgwp9DNly5FcgX6V55?=
 =?us-ascii?q?GSU0wTWom3VForsgRq4brdJCslguGcnXQ+NKC1tmeSndMiH60j1grlY8cZO6?=
 =?us-ascii?q?TCFhe6EtVGVZL3cKpwwALvNU9CZbEPkcx8d8K+K6ncgfbtZr062mn7yz0Wvs?=
 =?us-ascii?q?h8yh7erXMkDLSThdBenrfGg0OGT2uu1g759Jqsw8YfOHdMQCKpwCzgTtcANJ?=
 =?us-ascii?q?03Rp4CDCKVG+Pyw9x/g5D3XHsBqwy4AxUAxNPsZQrUZFu73xUCjB1L80zioj?=
 =?us-ascii?q?OxynlPqx9strCWhXOc2OCkcgYbf3JbAmJly1X0c9G5?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0ABAABJGzhcmEUj6NJkGgEBAQEBAgE?=
 =?us-ascii?q?BAQEHAgEBAQGBUQUBAQEBCwGCAIE4IQMHCCeMG1+NHZd3gXuEeQI1ghEBBS8?=
 =?us-ascii?q?JDQEDAQECAQEBARQBAQEBAQYNCwYpL4VLAwN5ECAMJQ9IBxKDIoIBrwuJBIE?=
 =?us-ascii?q?sh36BfYRaiG2GFwKHQAeBbodBkQEJkX8YkXwtiUGSOYIOhCyCNY42MAEBATA?=
 =?us-ascii?q?BiASCTQEB?=
X-SPF-Status: pass
Received: from mail05.ics.ntt-tx.co.jp (HELO mail04.ics.ntt-tx.co.jp) ([210.232.35.69])
  by dcma-spm02.ecl.ntt.co.jp with ESMTP; 11 Jan 2019 13:30:24 +0900
Received: from gwchk03.silk.ntt-tx.co.jp (gwchk03.silk.ntt-tx.co.jp [10.107.0.111])
	by mail04.ics.ntt-tx.co.jp (unknown) with ESMTP id x0B4UAeT027576;
	Fri, 11 Jan 2019 13:30:10 +0900
Received: (from root@localhost)
	by gwchk03.silk.ntt-tx.co.jp (unknown) id x0B4U8GG000518;
	Fri, 11 Jan 2019 13:30:08 +0900
Received: from gwchk.silk.ntt-tx.co.jp [10.107.0.110] 
	 by gwchk03.silk.ntt-tx.co.jp with ESMTP id PAA31925;
	 Fri, 11 Jan 2019 13:27:44 +0900
Received: from imss03.silk.ntt-tx.co.jp (localhost [127.0.0.1]) by imss03.silk.ntt-tx.co.jp (unknown) with ESMTP id x0B4Rh2u023492; Fri, 11 Jan 2019 13:27:43 +0900
Received: from mgate02.silk.ntt-tx.co.jp (smtp02.silk.ntt-tx.co.jp [10.107.0.37]) by imss03.silk.ntt-tx.co.jp (unknown) with ESMTP id x0B4RhJZ023488; Fri, 11 Jan 2019 13:27:43 +0900
Message-Id: <201901110427.x0B4RhJZ023488@imss03.silk.ntt-tx.co.jp>
Received: from localhost by mgate02.silk.ntt-tx.co.jp (unknown)
	id x0B4RhRV008276 ; Fri, 11 Jan 2019 13:27:43 +0900
From: x-fn-spp@sl.ntt-tx.co.jp
To: ferruh.yigit@intel.com, ogawa.yasufumi@lab.ntt.co.jp
Cc: spp@dpdk.org
Subject: [PATCH 2/3] spp_vf: improve command response time
Date: Fri, 11 Jan 2019 13:27:42 +0900
X-Mailer: git-send-email 2.18.0
In-Reply-To: <20190111042743.22673-1-x-fn-spp@sl.ntt-tx.co.jp>
References: <20190111042743.22673-1-x-fn-spp@sl.ntt-tx.co.jp>
X-TM-AS-MML: disable

From: Hideyuki Yamashita <yamashita.hideyuki@po.ntt-tx.co.jp>

This patch improves command response time of spp_vf.

Signed-off-by: Hideyuki Yamashita <yamashita.hideyuki@po.ntt-tx.co.jp>
Signed-off-by: Naoki Takada <takada.naoki@lab.ntt.co.jp>
---
 src/vf/spp_vf.c | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/src/vf/spp_vf.c b/src/vf/spp_vf.c
index 4e4a8e1..b81ad11 100644
--- a/src/vf/spp_vf.c
+++ b/src/vf/spp_vf.c
@@ -349,7 +349,12 @@ main(int argc, char *argv[])
 			if (unlikely(ret_do != SPP_RET_OK))
 				break;
 
-			sleep(1);
+		       /*
+			* To avoid making CPU busy, this thread waits
+			* here for 100 ms.
+			*/
+
+			usleep(100);
 
 #ifdef SPP_RINGLATENCYSTATS_ENABLE
 			print_ring_latency_stats();
-- 
2.17.1



