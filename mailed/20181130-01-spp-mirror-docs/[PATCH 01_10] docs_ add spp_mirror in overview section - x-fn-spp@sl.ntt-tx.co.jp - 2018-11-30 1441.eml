X-Account-Key: account4
X-UIDL: 00008a3d56a584ea
X-Mozilla-Status: 0001
X-Mozilla-Status2: 00000000
X-Mozilla-Keys:                                                                                 
Return-Path: <x-fn-spp@sl.ntt-tx.co.jp>
X-Original-To: yo128@mail2.ecl.ntt.co.jp
Delivered-To: yo128@mail2.ecl.ntt.co.jp
Received: from dmail1.ecl.ntt.co.jp (dmail1.ecl.ntt.co.jp [129.60.86.151])
	by jcms-pop21.ecl.ntt.co.jp (Postfix) with ESMTP id C73E1400B05
	for <yo128@mail2.ecl.ntt.co.jp>; Fri, 30 Nov 2018 14:43:41 +0900 (JST)
Received: by dmail1.ecl.ntt.co.jp (Postfix)
	id C301B23BA79; Fri, 30 Nov 2018 14:43:41 +0900 (JST)
Delivered-To: ogawa.yasufumi@lab.ntt.co.jp
Received: from vc2.ecl.ntt.co.jp (vc2.ecl.ntt.co.jp [129.60.86.154])
	by dmail1.ecl.ntt.co.jp (Postfix) with ESMTP id C268B23B88B
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 30 Nov 2018 14:43:41 +0900 (JST)
Received: from vc2.ecl.ntt.co.jp (localhost [127.0.0.1])
	by vc2.ecl.ntt.co.jp (Postfix) with ESMTP id B3E4F6391CA
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 30 Nov 2018 14:43:41 +0900 (JST)
Received: from dcma-spm01.ecl.ntt.co.jp (unknown [129.60.87.149])
	by vc2.ecl.ntt.co.jp (Postfix) with ESMTP id 8F860639042
	for <ogawa.yasufumi@lab.ntt.co.jp>; Fri, 30 Nov 2018 14:43:41 +0900 (JST)
Authentication-Results: dcma-spm01.ecl.ntt.co.jp; spf=Pass smtp.pra=x-fn-spp@sl.ntt-tx.co.jp; spf=Pass smtp.mailfrom=x-fn-spp@sl.ntt-tx.co.jp
Received-SPF: Pass (dcma-spm01.ecl.ntt.co.jp: domain of
  x-fn-spp@sl.ntt-tx.co.jp designates 210.232.35.69 as
  permitted sender) identity=pra; client-ip=210.232.35.69;
  receiver=dcma-spm01.ecl.ntt.co.jp;
  envelope-from="x-fn-spp@sl.ntt-tx.co.jp";
  x-sender="x-fn-spp@sl.ntt-tx.co.jp";
  x-conformance=sidf_strict; x-record-type="v=spf1";
  x-record-text="v=spf1 a:mail03.ics.ntt-tx.co.jp
  a:mail04.ics.ntt-tx.co.jp a:mail05.ics.ntt-tx.co.jp
  a:mail06.ics.ntt-tx.co.jp a:mail07.ics.ntt-tx.co.jp
  a:mail08.ics.ntt-tx.co.jp ip4:210.232.35.195
  ip4:210.232.35.196 ip4:210.232.35.65 ip4:210.232.35.66 ~all"
Received-SPF: Pass (dcma-spm01.ecl.ntt.co.jp: domain of
  x-fn-spp@sl.ntt-tx.co.jp designates 210.232.35.69 as
  permitted sender) identity=mailfrom; client-ip=210.232.35.69;
  receiver=dcma-spm01.ecl.ntt.co.jp;
  envelope-from="x-fn-spp@sl.ntt-tx.co.jp";
  x-sender="x-fn-spp@sl.ntt-tx.co.jp";
  x-conformance=sidf_strict; x-record-type="v=spf1";
  x-record-text="v=spf1 a:mail03.ics.ntt-tx.co.jp
  a:mail04.ics.ntt-tx.co.jp a:mail05.ics.ntt-tx.co.jp
  a:mail06.ics.ntt-tx.co.jp a:mail07.ics.ntt-tx.co.jp
  a:mail08.ics.ntt-tx.co.jp ip4:210.232.35.195
  ip4:210.232.35.196 ip4:210.232.35.65 ip4:210.232.35.66 ~all"
IronPort-PHdr: =?us-ascii?q?9a23=3A6YPrOBDA9GJqImlm9rhEUyQJPHJ1kqjoPgMT9p?=
 =?us-ascii?q?ssgq5PdaLmxZn5IUjD/qw00w3FVoDSrulcjrKP9a3rXSoG/YrHu3dEcoQfHw?=
 =?us-ascii?q?Qdh5Aulhc7SNWAFVW9NOTjOjx/EsIHT0d912q/d05JBIPidxvZpTuw9W1aAQ?=
 =?us-ascii?q?3xYDJ8Pf+9AYvOl4Ky3uG29YfUZlBYwTS7JKhqND2tqUPXqtVTnZskIaF3yA?=
 =?us-ascii?q?OQ+Clydu9bxH1lKReopziivpjixJd46GwQt/kk/otbSaCiJuI1RrgeCig6dW?=
 =?us-ascii?q?syos/z51HPSg6G531UVWtz8FIAE03L6lThRo/ZqS+8sPZhnTWKe8bxC7IsET?=
 =?us-ascii?q?iv9KZkThb0hTxPbWdhtjuM0Ior0eQF8VqovHkdi8bMbZuQNeZic6+VZt4cSW?=
 =?us-ascii?q?dbH45QWyFHHoKgft4XFeNSde1croT7ux4PtU7kXFHqXri1jGQVwCGnjshYm6?=
 =?us-ascii?q?w7HArL3RItBYcCu3Hd6c7tMf9LF+2+yO/O0SmFZPQQ2y+ujeqAOh0nv/yIWq?=
 =?us-ascii?q?p9NMTLzkx6XROAgFPVspT9FyiRkOIRry2H/6xrUqStkyR0zmM56ijq3coqho?=
 =?us-ascii?q?TT08gFj17CsD5h2K4uIZu+VFI+fc7iG5wWtTnQZO4UCosyBmpvvig90LgPv5?=
 =?us-ascii?q?W2KTMLxJoQ3ALFavebIMCYpwjuX+GLLXJklWpoLfih0g2q/xHqmYieHoGklU?=
 =?us-ascii?q?xHpS1fnpzQu2ARglbNv9OfRKI19xWk0DeLj1uV6+pfZ0Yoie/HO9gqxfgyjv?=
 =?us-ascii?q?9x+QzKTCr/mUGu0OmXfV5i/PS0rvj3JL7h4J2Ef4Ymjwj/Nvxz3M20GqI+Lh?=
 =?us-ascii?q?RLQ3jd8uP61qWGnwWxSedPh/wyyvefsZvBY8IHuuulE0le1cAh8162XTKv0d?=
 =?us-ascii?q?BAwj8GJ0kDfg6bypT5fVrJZvLgaJX3y13+lT5qw6iWeLzqGdPLMmSGjKendr?=
 =?us-ascii?q?E76VYUyRJvn4oGv9QOUetHe6+1Ax6s0b6QRh4hb17umr6hUo4nkNhDHzveXO?=
 =?us-ascii?q?eYKP+A6wbQoLh0ea/XOclL5X78M6R3vae2yyViwxlGIO/3g9MBYXS8VK08cX?=
 =?us-ascii?q?+UanftnNoNVFwykFRnFr7SgUaZGX5fbHO7Grkk42liTo+tCcHFWpzri7vH3j?=
 =?us-ascii?q?/pVpFRY2lHDBiLHxKKP82UHvkKLTmKOud6lnoCSaTkV59n3hbotheyx7d8L+?=
 =?us-ascii?q?XS8zEVrtq5jYAzvbaJ00pvs2IlR82GtgPFB3l5hGYJWyM70OhkrEpxx03Cma?=
 =?us-ascii?q?l0jvpEFMBCsvZAUwM0L5nZnKRxD9H/XB6Ef8/cEg/+BI/9W3dqE5RvkoxrAQ?=
 =?us-ascii?q?41AdipgxHd0jD/D7QQnvmQHJlsq+TR1Hy3IdphjX3Bkqs53DxECoNCM3Orgq?=
 =?us-ascii?q?ln+k3dHYnMxg+J0qisML8ExAbW8CGF0XbLoFEeWwk2U72PDhV9LgPG6M/04E?=
 =?us-ascii?q?/PVerkGfEpNE5a0daqMa8MbMH1yElWAvzkftbGKTHU+S/4FVODwbWCa5Dvcm?=
 =?us-ascii?q?MW0XDGCUQKpBsP53eNKVt2FmK7rmnZFjArCUP3bham77xlsH3iBBxRrUnCfw?=
 =?us-ascii?q?h72rGy4BJQmfGMV6ZZwOcfoCl44zwmGV+824qNTduLvExnYLkZfcN761AB13?=
 =?us-ascii?q?q81UQ1N86lJqFm3gJYcg9s+UXyy1BrGsNLlo4otDsjng97KKbAjRVAfCje24?=
 =?us-ascii?q?zsf6HHbGL1uhK3DsyekliM1d+X/v9RrvUzsBPloB3sClpk+HIh0cEd2imZ75?=
 =?us-ascii?q?TOVFVUUJnqFEAr611mt/fRZW8//+a2nTVlY6y9szuai5QoD/BjzAq8OstPdq?=
 =?us-ascii?q?iDUg3qW8wCW5r0cbRswQPzKElZerkDqctWd4unb6fUgvfzerw7xnT90CIesd?=
 =?us-ascii?q?4101rQpXAlEqiShMxDmKzegFbPVi+g3g346oatwtoCPmxUQDT33yHgAMQIN/?=
 =?us-ascii?q?9COL0TAGLrGPWZg9B3hprjQXldrQHxHFdA3tO1PAaCKVf6mw9Ihx1O/S6X3B?=
 =?us-ascii?q?CgxjkxqAkH67KF1XWRkf/mMhwbJitXVC9pihHuOdrtgg=3D=3D?=
X-IronPort-Anti-Spam-Filtered: true
X-IronPort-Anti-Spam-Result: =?us-ascii?q?A0AAAAC1zQBcl0Uj6NJjGgEBAQEBAgE?=
 =?us-ascii?q?BAQEHAgEBAQGBUQUBAQEBCwGCAGlPIQMHCCeMEV+NNpdGgXoyhEcCNYMeAQU?=
 =?us-ascii?q?vCQ0BAwEBAgEBAQEUAQEBAQEGGAZMDIU9BnkQIAwlD0gHEoMhAYIAEKh5hEF?=
 =?us-ascii?q?AhAOBLIdsgWeEWoEQAYYwA4IGhRMiAocdB4IHhnKQCQmGf4o3GJEcLIhNhGO?=
 =?us-ascii?q?MQYINhCwJgiyIZ4VOMAEBATABjwcBAQ?=
X-SPF-Status: pass
Received: from mail05.ics.ntt-tx.co.jp (HELO mail04.ics.ntt-tx.co.jp) ([210.232.35.69])
  by dcma-spm01.ecl.ntt.co.jp with ESMTP; 30 Nov 2018 14:43:41 +0900
Received: from gwchk03.silk.ntt-tx.co.jp (gwchk03.silk.ntt-tx.co.jp [10.107.0.111])
	by mail04.ics.ntt-tx.co.jp (unknown) with ESMTP id wAU5hVpm001642;
	Fri, 30 Nov 2018 14:43:31 +0900
Received: (from root@localhost)
	by gwchk03.silk.ntt-tx.co.jp (unknown) id wAU5hVdw028345;
	Fri, 30 Nov 2018 14:43:31 +0900
Received: from gwchk.silk.ntt-tx.co.jp [10.107.0.110] 
	 by gwchk03.silk.ntt-tx.co.jp with ESMTP id QAA27149;
	 Fri, 30 Nov 2018 14:41:19 +0900
Received: from imss04.silk.ntt-tx.co.jp (localhost [127.0.0.1]) by imss04.silk.ntt-tx.co.jp (unknown) with ESMTP id wAU5fJFW001774; Fri, 30 Nov 2018 14:41:19 +0900
Received: from mgate01.silk.ntt-tx.co.jp (smtp02.silk.ntt-tx.co.jp [10.107.0.37]) by imss04.silk.ntt-tx.co.jp (unknown) with ESMTP id wAU5fJVH001768; Fri, 30 Nov 2018 14:41:19 +0900
Message-Id: <201811300541.wAU5fJVH001768@imss04.silk.ntt-tx.co.jp>
Received: from localhost by mgate01.silk.ntt-tx.co.jp (unknown)
	id wAU5fJ5M014150 ; Fri, 30 Nov 2018 14:41:19 +0900
From: x-fn-spp@sl.ntt-tx.co.jp
To: ferruh.yigit@intel.com, ogawa.yasufumi@lab.ntt.co.jp
Cc: spp@dpdk.org
Subject: [PATCH 01/10] docs: add spp_mirror in overview section
Date: Fri, 30 Nov 2018 14:41:09 +0900
X-Mailer: git-send-email 2.18.0
In-Reply-To: <20181130054118.24543-1-x-fn-spp@sl.ntt-tx.co.jp>
References: <20181130054118.24543-1-x-fn-spp@sl.ntt-tx.co.jp>
X-TM-AS-MML: disable

From: Hideyuki Yamashita <yamashita.hideyuki@po.ntt-tx.co.jp>

Add overview of spp_mirror beside spp_vf.

Signed-off-by: Hideyuki Yamashita <yamashita.hideyuki@po.ntt-tx.co.jp>
Signed-off-by: Yasufumi Ogawa <ogawa.yasufumi@lab.ntt.co.jp>
---
 docs/guides/spp_vf/overview.rst | 71 +++++++++++++++++++++++++++++++++--------
 1 file changed, 58 insertions(+), 13 deletions(-)

diff --git a/docs/guides/spp_vf/overview.rst b/docs/guides/spp_vf/overview.rst
index 4773213..dd957d4 100644
--- a/docs/guides/spp_vf/overview.rst
+++ b/docs/guides/spp_vf/overview.rst
@@ -6,24 +6,44 @@
 Overview
 ========
 
-SPP_VF provides SR-IOV like network functionality using DPDK for NFV.
+This section describes an overview of SPP's extensions, ``spp_vf`` and
+``spp_mirror``.
+SPP provides a connectivity between DPDK processes as a virtual patch panel.
+However, It is not sufficient considering more practical usecases.
+For instance, you might need a classification for incoming packets if you have
+multiple processes as destinations. You might also need to duplicate packets
+for monitoring or inspection.
 
-PP_VF distributes incoming packets to VMs with referring to virtual
-MAC address like Virtual Function(VF) of SR-IOV.
-Virtual MAC address can be defined by commands from spp
-controller(``spp_vf.py``).
+``spp_vf`` is a SPP secondary process for forwarding packets to multiple
+destination ports with a MAC address classification. It is also supported to
+merge from several source ports to aggregate packets to a destination port.
 
-SPP_VF is multi-process and multi-thread applications. A SPP_VF process
-is referred to as ``spp_vf`` in this document. Each ``spp_vf`` has
-one manager thread and component threads. The manager thread provides
-function for command processing and creating the component threads.
-The component threads have its own multiple components, ports and
-classifier tables including Virtual MAC address.
+``spp_mirror`` is an another kind of secondary process to duplicate incoming
+packets. This feature is intended to use as a
+`TaaS
+<https://docs.openstack.org/dragonflow/latest/specs/tap_as_a_service.html>`_
+feature for port mirroring introduced in OpenStack.
 
 
+spp_vf
+------
+
+``spp_vf`` provides a SR-IOV like network feature.
+
+``spp_vf`` forwards incoming packets to several destination VMs by referring
+MAC address like as a Virtual Function (VF) of SR-IOV.
+
+``spp_vf`` is a  multi-process and multi-thread application.
+Each of ``spp_vf`` has one manager thread and worker threads called as
+components.
+The manager thread provides a function for parsing a command and creating the
+components.
+The component threads have its own multiple components, ports and classifier
+tables including Virtual MAC address.
+
 This is an example of network configuration, in which one
 ``classifier_mac``,
-one merger and four forwarders are running in SPP_VF process
+one merger and four forwarders are running in ``spp_vf`` process
 for two destinations of vhost interface.
 Incoming packets from rx on host1 are sent to each of vhosts of VM
 by looking up destination MAC address in the packet.
@@ -31,4 +51,29 @@ by looking up destination MAC address in the packet.
 .. figure:: ../images/spp_vf/spp_vf_overview.*
     :width: 70%
 
-    Overview of SPP VF
+    Overview of spp_vf
+
+
+SPP Mirror
+----------
+
+``spp_mirror`` is an implementation of
+`TaaS
+<https://docs.openstack.org/dragonflow/latest/specs/tap_as_a_service.html>`_
+as a SPP secondary process for port mirroring.
+TaaS stands for TAP as a Service.
+
+``spp_mirror`` consists of one manager thread and worker threads as similar to
+``spp_vf``, but just one worker role for mirroring.
+:numref:`figure_spp_mirror_overview` shows an overview of use of ``spp_mirror``
+in which ``spp_mirror`` process receives packets from ``ring:0`` in ``spp_vf``
+for duplicating the packets for monitoring.
+Worker thread ``mirror`` has two of tx rings for forwaring the packets to the
+destination and a monitor application running on VM3.
+
+.. _figure_spp_mirror_overview:
+
+.. figure:: ../images/spp_vf/spp_mirror_overview.*
+   :width: 70%
+
+   Overview of spp_mirror
-- 
2.7.4


